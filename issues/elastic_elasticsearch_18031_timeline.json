[
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/643986387", 
        "created_at": "2016-04-28T08:31:46Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "labeled", 
        "label": {
            "color": "4a4ea8", 
            "name": "enhancement"
        }, 
        "id": 643986387
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/643986388", 
        "created_at": "2016-04-28T08:31:46Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "labeled", 
        "label": {
            "color": "009800", 
            "name": ":Aggregations"
        }, 
        "id": 643986388
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/643986389", 
        "created_at": "2016-04-28T08:31:46Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "labeled", 
        "label": {
            "color": "dddddd", 
            "name": "v5.0.0"
        }, 
        "id": 643986389
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/643986481", 
        "created_at": "2016-04-28T08:31:52Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "assigned", 
        "assignee": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "id": 643986481
    }, 
    {
        "source": {
            "url": "https://api.github.com/repos/elastic/elasticsearch/issues/18003", 
            "id": 151327654, 
            "actor": {
                "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
                "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
                "organizations_url": "https://api.github.com/users/jpountz/orgs", 
                "url": "https://api.github.com/users/jpountz", 
                "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
                "html_url": "https://github.com/jpountz", 
                "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
                "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
                "repos_url": "https://api.github.com/users/jpountz/repos", 
                "received_events_url": "https://api.github.com/users/jpountz/received_events", 
                "gravatar_id": "", 
                "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
                "site_admin": false, 
                "login": "jpountz", 
                "type": "User", 
                "id": 299848, 
                "followers_url": "https://api.github.com/users/jpountz/followers"
            }
        }, 
        "created_at": "2016-04-28T05:32:21-03:00", 
        "updated_at": "2016-04-28T05:32:21-03:00", 
        "event": "cross-referenced"
    }, 
    {
        "body": "Many thanks for this, @jpountz .\r\nI see this uses term queries to derive counts on the fly when they aren't stored. \r\n\r\nHowever if we go down this route of deriving counts on the fly what do you think of an approach where we try to re-use the aggregation framework  - so a broadening of \"significant terms\" into \"significant buckets\". That would give us the flexibility to do the following analysis:\r\n\r\n* Individual terms (the limit of what we do today)\r\n* Numeric ranges e.g. age bands\r\n* Geo areas \r\n* Term groups (e.g. Java=[jsp,ejb,jts....] vs Javascript=[react,angular...] vs ..)\r\n\r\nIn each of these scenarios the significance algorithm is tuning out the uneven-ness in the data in order to identify buckets of interest e.g. those with a propensity to commit a crime or purchase a product.  We know so much of data is Zipfy and skewed towards the popular so background-diffing is a useful lens through which to view most data (e.g. in the same way \"per-capita\" stats help as a saner basis of comparisons).\r\n\r\nThere are several advantages to re-using aggs for the bulk of this work:\r\n1) Bucket aggs provide a clean syntax for grouping low-level index entries (e.g. date agg's \"1m\", \"1w\" etc)\r\n2) Metric aggs allow us to sum things like paymentAmount - this can be a more useful number to consider as a basis for computing significance than what we use today (just volumes of documents)\r\n\r\nThere's a lot to think about in adopting an agg-based approach - the JSON syntax, the changes to existing aggs to support this background-stats use case. I appreciate this is likely too much to debate here on this PR but I wanted to run it by you because it is related to the changes being made here.\r\n\r\n\r\n\r\n\r\n\r\n\r\n", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/215368335", 
        "event": "commented", 
        "created_at": "2016-04-28T09:39:28Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-215368335", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "updated_at": "2016-04-28T10:27:48Z", 
        "user": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "id": 215368335, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/644060830", 
        "created_at": "2016-04-28T09:39:28Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "mentioned", 
        "id": 644060830
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/644060831", 
        "created_at": "2016-04-28T09:39:28Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "subscribed", 
        "id": 644060831
    }, 
    {
        "body": "I think that is worth exploring but this looks quite ambitious at the same time. We should try to do baby steps as much as possible. The first one would probably to be to compute doc counts of the background set using doc values (just like an aggregation would do).Then we could try to see how we can plug the terms agg in to do the job. And afterwards maybe supporting arbitrary numeric metric aggs.", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/215434273", 
        "event": "commented", 
        "created_at": "2016-04-28T14:06:17Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-215434273", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "updated_at": "2016-04-28T14:06:17Z", 
        "user": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "id": 215434273, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "body": "Was trying with my weblog data to test performance but hit this array index out of bounds exception:\r\n\r\n\tDELETE test\r\n\r\n\tPUT test\r\n\t{\r\n\t   \"settings\": {\r\n\t\t  \"number_of_replicas\": 0,\r\n\t\t  \"number_of_shards\":1\r\n\t   },\r\n\t   \"mappings\": {\r\n\t\t  \"test\": {                \r\n\t\t\t \"properties\": {\r\n\t\t\t\t\"ipField\": {\r\n\t\t\t\t   \"type\": \"ip\"\r\n\t\t\t\t}\r\n\t\t\t }\r\n\t\t  }\r\n\t   }\r\n\t}\r\n\r\n\r\n\tPOST test/test\r\n\t{\"ipField\":\"95.108.241.251\"}\r\n\tPOST test/test\r\n\t{\"ipField\":\"95.108.241.251\"}\r\n\tPOST test/test\r\n\t{\"ipField\":\"95.108.241.251\"}\r\n\tPOST test/test\r\n\t{\"ipField\":\"95.108.241.251\"}\r\n\r\n\r\n\tGET test/_search?q=95.108.241.251\r\n\t{\r\n\t   \"size\":0,\r\n\t   \"aggs\": {\r\n\t\t  \"boom\": {\r\n\t\t\t \"significant_terms\": {\r\n\t\t\t\t\"field\": \"ipField\"\r\n\t\t\t }\r\n\t\t  }\r\n\t   }\r\n\t}\r\n\r\nException:\r\n\r\n\tFailed to execute phase [merge], [reduce] \r\n\t\tat org.elasticsearch.action.search.SearchQueryAndFetchAsyncAction$1.onFailure(SearchQueryAndFetchAsyncAction.java:77)\r\n\t\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:438)\r\n\t\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n\t\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\t\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\t\tat java.lang.Thread.run(Thread.java:745)\r\n\tCaused by: java.lang.ArrayIndexOutOfBoundsException: 16\r\n\t\tat org.apache.lucene.util.UnicodeUtil.UTF8toUTF16(UnicodeUtil.java:602)\r\n\t\tat org.apache.lucene.util.BytesRef.utf8ToString(BytesRef.java:152)\r\n\t\tat org.elasticsearch.search.aggregations.bucket.significant.SignificantStringTerms$Bucket.getKeyAsString(SignificantStringTerms.java:115)\r\n\t\tat org.elasticsearch.search.aggregations.bucket.significant.InternalSignificantTerms.doReduce(InternalSignificantTerms.java:176)\r\n\t\tat org.elasticsearch.search.aggregations.InternalAggregation.reduce(InternalAggregation.java:158)\r\n\t\tat org.elasticsearch.search.aggregations.InternalAggregations.reduce(InternalAggregations.java:159)\r\n\t\tat org.elasticsearch.search.controller.SearchPhaseController.merge(SearchPhaseController.java:403)\r\n\t\tat org.elasticsearch.action.search.SearchQueryAndFetchAsyncAction$1.doRun(SearchQueryAndFetchAsyncAction.java:65)\r\n\t\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:452)\r\n\t\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)    ", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/216501771", 
        "event": "commented", 
        "created_at": "2016-05-03T11:33:38Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-216501771", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "updated_at": "2016-05-03T11:33:38Z", 
        "user": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "id": 216501771, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "body": "@markharwood I pushed a new commit to address your comment about the documentation.\r\n\r\nRegarding the test failure you got, we need #18003 to make terms aggs work with ip addresses. The issue here is that elasticsearch tried to convert some ip bytes to an utf8 string, but this failed since the array boundary was crossed while reading what looked like a 4-bytes UTF8 code point.", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/216783850", 
        "event": "commented", 
        "created_at": "2016-05-04T08:30:21Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-216783850", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "updated_at": "2016-05-04T08:30:21Z", 
        "user": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "id": 216783850, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/649864326", 
        "created_at": "2016-05-04T08:30:21Z", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "event": "mentioned", 
        "id": 649864326
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/649864327", 
        "created_at": "2016-05-04T08:30:22Z", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "event": "subscribed", 
        "id": 649864327
    }, 
    {
        "body": "For now I hacked SignificantStringTerms.getKeyAsString() so I can run some benchmarks without causing errors. There was a noticeable slow-down on IP address fields compared to the `keyword` equivalent on my test index (~4 times slower) but that is to be expected.", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/216891462", 
        "event": "commented", 
        "created_at": "2016-05-04T14:57:22Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-216891462", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "updated_at": "2016-05-04T14:57:22Z", 
        "user": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "id": 216891462, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "body": "@markharwood Do you think this is good to merge or would you like me to change the way it works?", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/218176949", 
        "event": "commented", 
        "created_at": "2016-05-10T14:35:36Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-218176949", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "updated_at": "2016-05-10T14:35:36Z", 
        "user": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "id": 218176949, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/655850030", 
        "created_at": "2016-05-10T14:35:36Z", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "event": "mentioned", 
        "id": 655850030
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/655850031", 
        "created_at": "2016-05-10T14:35:36Z", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "event": "subscribed", 
        "id": 655850031
    }, 
    {
        "body": "My only concern was around the likelihood of duplicated frequency lookups when a sig_term agg is embedded under a parent terms agg or similar. I experimented with adding a term->count cache on some weblog data but failed to get a noticeable improvement. There may already be some caching effects occurring at the Lucene or OS file system level that make this agg-level caching redundant?\r\n\r\nOtherwise LGTM", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/218210842", 
        "event": "commented", 
        "created_at": "2016-05-10T16:18:55Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-218210842", 
        "actor": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "updated_at": "2016-05-10T16:18:55Z", 
        "user": {
            "following_url": "https://api.github.com/users/markharwood/following{/other_user}", 
            "events_url": "https://api.github.com/users/markharwood/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/markharwood/orgs", 
            "url": "https://api.github.com/users/markharwood", 
            "gists_url": "https://api.github.com/users/markharwood/gists{/gist_id}", 
            "html_url": "https://github.com/markharwood", 
            "subscriptions_url": "https://api.github.com/users/markharwood/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/170925?v=3", 
            "repos_url": "https://api.github.com/users/markharwood/repos", 
            "received_events_url": "https://api.github.com/users/markharwood/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/markharwood/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "markharwood", 
            "type": "User", 
            "id": 170925, 
            "followers_url": "https://api.github.com/users/markharwood/followers"
        }, 
        "id": 218210842, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "body": "There is caching happening indeed through the filesystem and the query cache. It is not as efficient as the terms enum though, which even if it did not cache, would still have the benefit of reusing `IndexInput`s.", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/comments/218216046", 
        "event": "commented", 
        "created_at": "2016-05-10T16:37:26Z", 
        "html_url": "https://github.com/elastic/elasticsearch/pull/18031#issuecomment-218216046", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "updated_at": "2016-05-10T16:37:26Z", 
        "user": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "id": 218216046, 
        "issue_url": "https://api.github.com/repos/elastic/elasticsearch/issues/18031"
    }, 
    {
        "committer": {
            "date": "2016-05-11T14:52:58Z", 
            "name": "Adrien Grand", 
            "email": "jpountz@gmail.com"
        }, 
        "author": {
            "date": "2016-04-27T18:59:28Z", 
            "name": "Adrien Grand", 
            "email": "jpountz@gmail.com"
        }, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/git/commits/866a5459f023e4fa2775eb9158d03342e6221fd0", 
        "tree": {
            "url": "https://api.github.com/repos/elastic/elasticsearch/git/trees/a6ce468e851c40368bd71dfcb134ee1854f63e86", 
            "sha": "a6ce468e851c40368bd71dfcb134ee1854f63e86"
        }, 
        "html_url": "https://github.com/elastic/elasticsearch/commit/866a5459f023e4fa2775eb9158d03342e6221fd0", 
        "sha": "866a5459f023e4fa2775eb9158d03342e6221fd0", 
        "parents": [
            {
                "url": "https://api.github.com/repos/elastic/elasticsearch/git/commits/e4edee5d9a7ae6e03e3062a3f141d22fc8ad0bd1", 
                "sha": "e4edee5d9a7ae6e03e3062a3f141d22fc8ad0bd1", 
                "html_url": "https://github.com/elastic/elasticsearch/commit/e4edee5d9a7ae6e03e3062a3f141d22fc8ad0bd1"
            }
        ], 
        "message": "Make significant terms work on fields that are indexed with points. #18031\n\nIt will keep using the caching terms enum for keyword/text fields and falls back\nto IndexSearcher.count for fields that do not use the inverted index for\nsearching (such as numbers and ip addresses). Note that this probably means that\nsignificant terms aggregations on these fields will be less efficient than they\nused to be. It should be ok under a sampler aggregation though.\n\nThis moves tests back to the state they were in before numbers started using\npoints, and also adds a new test that significant terms aggs fail if a field is\nnot indexed.\n\nIn the long term, we might want to follow the approach that Robert initially\nproposed that consists in collecting all documents from the background filter in\norder to compute frequencies using doc values. This would also mean that\nsignificant terms aggregations do not require fields to be indexed anymore.", 
        "event": "committed"
    }, 
    {
        "commit_id": "866a5459f023e4fa2775eb9158d03342e6221fd0", 
        "commit_url": "https://api.github.com/repos/elastic/elasticsearch/commits/866a5459f023e4fa2775eb9158d03342e6221fd0", 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/657287512", 
        "created_at": "2016-05-11T14:53:45Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "merged", 
        "id": 657287512
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/657287518", 
        "created_at": "2016-05-11T14:53:45Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "closed", 
        "id": 657287518
    }, 
    {
        "commit_id": null, 
        "commit_url": null, 
        "url": "https://api.github.com/repos/elastic/elasticsearch/issues/events/657339025", 
        "created_at": "2016-05-11T15:23:09Z", 
        "actor": {
            "following_url": "https://api.github.com/users/jpountz/following{/other_user}", 
            "events_url": "https://api.github.com/users/jpountz/events{/privacy}", 
            "organizations_url": "https://api.github.com/users/jpountz/orgs", 
            "url": "https://api.github.com/users/jpountz", 
            "gists_url": "https://api.github.com/users/jpountz/gists{/gist_id}", 
            "html_url": "https://github.com/jpountz", 
            "subscriptions_url": "https://api.github.com/users/jpountz/subscriptions", 
            "avatar_url": "https://avatars.githubusercontent.com/u/299848?v=3", 
            "repos_url": "https://api.github.com/users/jpountz/repos", 
            "received_events_url": "https://api.github.com/users/jpountz/received_events", 
            "gravatar_id": "", 
            "starred_url": "https://api.github.com/users/jpountz/starred{/owner}{/repo}", 
            "site_admin": false, 
            "login": "jpountz", 
            "type": "User", 
            "id": 299848, 
            "followers_url": "https://api.github.com/users/jpountz/followers"
        }, 
        "event": "head_ref_deleted", 
        "id": 657339025
    }
]